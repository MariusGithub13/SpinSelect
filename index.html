<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpinSelect Pro | Advanced Customizable Picker Wheel</title>
    <meta name="description" content="Sleek, responsive, and highly customizable wheel spinner with advanced features for giveaways, decisions, team collaboration, and more. Perfect for selling on Whop.com.">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- Base Variables & Reset --- */
        :root {
            --primary: #6a11cb; /* Updated primary color */
            --primary-light: #a29bfe;
            --secondary: #2575fc; /* Added secondary for gradients */
            --accent: #ff5733; /* Updated accent */
            --dark: #333;
            --light: #fdfdfd;
            --gray: #e9e9e9;
            --success: #2ecc71;
            --warning: #f1c40f;
            --danger: #e74c3c;
            --shadow: 0 12px 35px rgba(0, 0, 0, 0.1);
            --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.07);
            --transition: all 0.35s cubic-bezier(0.25, 0.8, 0.25, 1);
            --border-radius: 12px; /* Consistent border radius */
            --font-family: 'Poppins', sans-serif; /* Changed font */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-family);
            background-color: #f4f7f6; /* Slightly different background */
            color: var(--dark);
            line-height: 1.7;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1300px;
            margin: 1rem auto; /* Added top margin */
            padding: 1.5rem;
            flex-grow: 1; /* Make container take available space */
        }

        /* --- Header --- */
        header {
            text-align: center;
            margin-bottom: 2.5rem;
            animation: fadeInDown 0.8s ease-out;
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            /* Updated gradient */
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
            letter-spacing: -1px;
        }

        .tagline {
            font-size: 1.3rem;
            color: #555;
            margin-bottom: 1.5rem;
            font-weight: 400;
        }

        /* --- Main App Layout --- */
        .app-container {
            display: grid;
            /* Adjusted grid for better balance */
            grid-template-columns: 350px 1fr;
            gap: 2.5rem; /* Increased gap */
            background: var(--light);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 2.5rem; /* Increased padding */
            animation: fadeInUp 0.8s ease-out;
            position: relative;
            overflow: hidden; /* Keep overflow hidden */
            margin-bottom: 2rem;
        }

        /* --- Responsive Grid --- */
        @media (max-width: 992px) {
            .app-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            h1 { font-size: 2.4rem; }
            .tagline { font-size: 1.1rem; }
            .app-container { padding: 1.5rem; gap: 1.5rem; }
        }

        /* --- Controls Panel --- */
        .controls {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            height: fit-content; /* Prevent stretching */
        }

        .control-group {
            background: #fff; /* Lighter background for contrast */
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray); /* Subtle border */
            box-shadow: var(--shadow-light);
            transition: var(--transition);
            opacity: 1; /* For fade out animation */
            transform: translateY(0); /* For slide up animation */
        }

        .control-group.fade-out {
            animation: fadeOut 0.5s forwards;
        }

        .control-group:hover {
            border-color: var(--primary-light);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }

        h2 {
            font-size: 1.4rem; /* Slightly larger */
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.6rem; /* Increased gap */
        }

        .input-group {
            margin-bottom: 1rem;
            position: relative; /* For potential icons inside */
        }

        label {
            display: block;
            margin-bottom: 0.6rem; /* Increased margin */
            font-weight: 500;
            color: #444; /* Darker label */
            font-size: 0.95rem; /* Slightly smaller label */
        }

        input, textarea, select {
            width: 100%;
            padding: 0.9rem 1.1rem; /* Adjusted padding */
            border: 1px solid #ccc; /* Lighter border */
            border-radius: 8px; /* Slightly smaller radius */
            font-size: 1rem;
            font-family: inherit; /* Inherit font */
            transition: var(--transition);
            background-color: #fff;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.15); /* Adjusted shadow */
        }

        textarea {
            min-height: 130px;
            resize: vertical;
            line-height: 1.6;
        }

        /* Weighted Entry Styling (Example) */
        .entry-item {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            align-items: center;
        }
        .entry-item input[type="text"] { flex-grow: 1; }
        .entry-item input[type="number"] { width: 70px; text-align: center; }
        .entry-item button { padding: 0.3rem 0.6rem; font-size: 0.8rem; }

        /* --- Buttons --- */
        .btn {
            padding: 0.9rem 1.6rem; /* Adjusted padding */
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            text-decoration: none; /* For link buttons */
            white-space: nowrap; /* Prevent wrapping */
        }

        .btn i { line-height: 1; /* Align icons better */ }

        .btn-primary {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(106, 17, 203, 0.2);
        }

        .btn-primary:hover {
            background-color: #580ca7; /* Darker hover */
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(106, 17, 203, 0.3);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
            box-shadow: 0 4px 15px rgba(37, 117, 252, 0.2);
        }

        .btn-secondary:hover {
            background-color: #1f66e0; /* Darker hover */
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(37, 117, 252, 0.3);
        }

         .btn-accent {
            background-color: var(--accent);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 87, 51, 0.2);
        }

        .btn-accent:hover {
            background-color: #e64a19; /* Darker hover */
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(255, 87, 51, 0.3);
        }

        .btn-light {
            background-color: #f0f0f0;
            color: var(--dark);
            border: 1px solid #ddd;
        }
        .btn-light:hover {
            background-color: #e5e5e5;
             transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-group {
            display: flex;
            gap: 0.75rem; /* Increased gap */
            flex-wrap: wrap; /* Allow wrapping */
        }

        /* --- Wheel Container --- */
        .wheel-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around; /* Better spacing */
            position: relative;
            padding: 1rem;
            min-height: 500px; /* Ensure space */
            perspective: 1000px; /* For 3D effects */
        }

        .wheel-wrapper {
            position: relative;
            width: 90%; /* Responsive width */
            max-width: 550px; /* Increased max width */
            aspect-ratio: 1/1;
            margin: 1rem auto; /* Center and add margin */
            animation: zoomIn 0.7s ease-out;
        }

        .wheel {
            width: 100%;
            height: 100%;
            position: relative;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2), inset 0 0 15px rgba(0,0,0,0.1); /* Enhanced shadow */
            /* Improved transition for smoother spin */
            transition: transform 6s cubic-bezier(0.1, 0.7, 0.3, 1);
            transform: rotate(0deg);
            border: 10px solid white; /* Thicker border */
            background-color: var(--gray); /* Fallback background */
        }

        .wheel.spinning {
             /* Use a less bouncy ease-out during spin */
            transition: transform 6s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        .wheel-center {
            position: absolute;
            width: 70px; /* Larger center */
            height: 70px;
            background: linear-gradient(135deg, #ffffff, #f0f0f0); /* Gradient center */
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 1.8rem; /* Larger icon */
            border: 5px solid var(--light);
        }

        .wheel-section {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: bottom right;
            overflow: hidden;
            /* Advanced clip-path for better segment shapes */
            clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 50% 100%); /* Example */
            border-left: 1px solid rgba(255,255,255,0.2); /* Subtle separator */
            transition: var(--transition); /* For hover effects maybe */
        }

        .wheel-section-content {
            position: absolute;
            /* Adjust positioning and rotation for better text alignment */
            width: 150%; /* Adjust as needed */
            height: 150%; /* Adjust as needed */
            transform: translate(-25%, -10%) rotate(calc(var(--angle) / 2 + 270deg));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600; /* Bolder text */
            color: white;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            font-size: clamp(0.8rem, 3vw, 1.1rem); /* Responsive font size */
            text-align: center;
            padding: 0.5rem;
            word-break: break-word;
            user-select: none; /* Prevent text selection */
        }

        .pointer {
            position: absolute;
            top: -10px; /* Adjusted position */
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            z-index: 20;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 35px solid var(--danger); /* Larger pointer */
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.3));
            /* Animation */
            animation: bouncePointer 1.5s infinite ease-in-out;
        }

        .spin-btn {
            margin-top: 1rem; /* Reduced margin */
            padding: 1rem 2.8rem; /* Larger padding */
            font-size: 1.3rem; /* Larger font */
            font-weight: 700;
            border-radius: 50px;
            /* Updated gradient */
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 10px 25px rgba(106, 17, 203, 0.3);
            position: relative;
            overflow: hidden;
            z-index: 1;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease-out; /* Faster click transition */
        }

        .spin-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%; /* Start hidden */
            width: 100%;
            height: 100%;
            /* Shine effect gradient */
            background: linear-gradient(120deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.3) 50%, rgba(255,255,255,0) 100%);
            z-index: 1;
            transition: left 0.6s ease-out;
        }

        .spin-btn:hover:before {
            left: 100%; /* Move shine across */
        }

        .spin-btn:hover {
             box-shadow: 0 12px 30px rgba(106, 17, 203, 0.4);
             transform: translateY(-2px);
        }

        .spin-btn:active {
            transform: translateY(1px) scale(0.98); /* Subtle press effect */
            box-shadow: 0 6px 15px rgba(106, 17, 203, 0.2);
        }

        /* --- Customization & Advanced Settings --- */
        .theme-selector {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }
        .theme-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid var(--gray);
            transition: var(--transition);
            position: relative; /* For checkmark */
        }
        .theme-option:hover, .theme-option.active {
            border-color: var(--primary);
            transform: scale(1.1);
        }
        .theme-option.active::after {
            content: '\f00c'; /* Font Awesome check */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 0.8rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        /* Example Theme Colors */
        .theme-default { background: linear-gradient(45deg, #6a11cb, #2575fc); }
        .theme-sunset { background: linear-gradient(45deg, #ff8c00, #ff0080); }
        .theme-forest { background: linear-gradient(45deg, #138d75, #27ae60); }
        .theme-ocean { background: linear-gradient(45deg, #00c6ff, #0072ff); }

        .sound-toggle i { font-size: 1.2rem; }

        /* Advanced Settings Toggles */
        .toggle-switch {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 0.5rem;
        }
        .toggle-switch label { margin-bottom: 0; cursor: pointer;}
        .switch {
            position: relative;
            display: inline-block;
            width: 44px; /* Smaller switch */
            height: 24px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--success); }
        input:checked + .slider:before { transform: translateX(20px); }

        /* --- Social Sharing --- */
        .share-buttons {
            margin-top: 1rem;
            display: flex;
            gap: 0.8rem;
            justify-content: center; /* Center share buttons */
        }
        .share-btn {
            font-size: 1.5rem; /* Larger icons */
            color: #555;
            transition: var(--transition);
            text-decoration: none;
        }
        .share-btn:hover {
            transform: scale(1.2);
            color: var(--primary);
        }
        .share-btn.twitter:hover { color: #1DA1F2; }
        .share-btn.facebook:hover { color: #1877F2; }
        .share-btn.whatsapp:hover { color: #25D366; }
        .share-btn.copy:hover { color: var(--accent); }

        /* --- Premium Features & CTA --- */
        .premium-lock {
            position: relative;
            filter: grayscale(60%); /* More subtle lock */
            opacity: 0.8;
            pointer-events: none; /* Disable interaction */
            transition: var(--transition);
        }
        .premium-lock > *:not(.premium-badge) {
            pointer-events: none; /* Ensure children are not interactive */
        }

        body.premium .premium-lock {
            filter: grayscale(0%);
            opacity: 1;
            pointer-events: auto;
        }
        body.premium .premium-lock > * {
             pointer-events: auto;
        }
        body.premium .premium-badge {
            display: none; /* Hide badge when premium */
        }
        /* Adjust disabled state for premium */
        body.premium .premium-lock select,
        body.premium .premium-lock button,
        body.premium .premium-lock input,
        body.premium .premium-lock textarea {
            pointer-events: auto !important;
            opacity: 1 !important;
            cursor: pointer !important;
        }
        body.premium .premium-lock .toggle-switch input:disabled + .slider {
            cursor: pointer;
            opacity: 1;
        }
         body.premium .premium-lock .toggle-switch label {
            cursor: pointer;
            opacity: 1;
        }

        .premium-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary);
            color: white;
            padding: 0.3rem 0.8rem; /* More padding */
            border-radius: 20px;
            font-size: 0.75rem; /* Slightly smaller */
            font-weight: 600;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            cursor: help; /* Indicate it's informative */
            pointer-events: auto; /* Make badge clickable/hoverable */
        }

        .upgrade-cta {
            text-align: center;
            margin-top: 3rem; /* More space */
            padding: 2.5rem; /* More padding */
            background: linear-gradient(135deg, white, #f8f9fa); /* Subtle gradient */
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            animation: subtlePulse 2.5s infinite alternate ease-in-out;
            border: 1px solid var(--gray);
        }

         body.premium .upgrade-cta {
             display: none; /* Hide CTA when premium */
         }

        .upgrade-title {
            font-size: 1.8rem; /* Larger */
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .upgrade-subtitle {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 1.5rem;
        }

        /* Removed price - handled by Whop */

        .features-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); /* Wider columns */
            gap: 1.2rem; /* Increased gap */
            margin: 2rem 0;
            text-align: left;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 0.8rem; /* Increased gap */
            color: #444; /* Darker text */
            font-size: 1.05rem; /* Slightly larger */
        }

        .feature-item i {
            color: var(--success);
            font-size: 1.2rem; /* Larger icon */
            width: 20px; /* Align icons */
            text-align: center;
        }

        .upgrade-btn {
            margin-top: 1rem;
            padding: 1rem 2.5rem; /* Larger button */
            font-size: 1.1rem;
        }

        /* --- Winner Modal --- */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6); /* Darker overlay */
            backdrop-filter: blur(5px); /* Frosted glass effect */
            animation: fadeIn 0.5s;
        }

        .modal-content {
            background: white;
            margin: 10% auto; /* Vertically centered */
            padding: 3rem;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 500px;
            text-align: center;
            position: relative;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            animation: slideDown 0.5s ease-out;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            color: #aaa;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        .modal-close:hover { color: var(--danger); transform: scale(1.1); }

        .modal h2 {
            font-size: 2.2rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .winner-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent);
            margin: 1rem 0 2rem 0;
            padding: 1rem;
            background-color: #fff3e0; /* Highlight background */
            border-radius: 8px;
            border: 1px solid var(--warning);
        }

        .winner-list {
            list-style: none;
            padding: 0;
            margin: 1rem 0 2rem 0;
            max-height: 150px; /* Scrollable list for multiple winners */
            overflow-y: auto;
            text-align: left;
        }
        .winner-list li {
            font-size: 1.2rem;
            font-weight: 600;
            padding: 0.5rem 1rem;
            margin-bottom: 0.5rem;
            background-color: #e8f5e9;
            border-radius: 5px;
            border-left: 4px solid var(--success);
        }

        /* --- Animations --- */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }

        @keyframes subtlePulse {
            0% { transform: scale(1); box-shadow: var(--shadow); }
            100% { transform: scale(1.005); box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12); }
        }

        @keyframes bouncePointer {
            0%, 100% { transform: translate(-50%, 0); }
            50% { transform: translate(-50%, -5px); }
        }

        /* Confetti Container */
        #confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--primary); /* Will be overridden */
            opacity: 1;
            transform: rotate(0deg);
            animation: fall 3s linear forwards;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }


        /* --- Footer --- */
        footer {
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            font-size: 0.9rem;
            color: #777;
        }

        /* --- Utility Classes --- */
        .hidden { display: none; }
        .text-center { text-align: center; }
        .mt-1 { margin-top: 1rem; }
        .mb-1 { margin-bottom: 1rem; }

    </style>
</head>
<body class=""> <div class="container">
        <header>
            <h1>SpinSelect Pro</h1>
            <p class="tagline">Advanced Random Picker Wheel: Customize, Share & Collaborate</p>
        </header>

        <div class="app-container">
            <div class="controls">

                <div class="control-group">
                    <h2><i class="fas fa-list-ul"></i> Entries</h2>
                    <div class="input-group">
                        <label for="entries">Add items (one per line)</label>
                        <textarea id="entries" placeholder="Entry 1\nEntry 2 (Weight: 3)\nEntry 3\n..."></textarea>
                        <small style="color:#777; font-size: 0.8rem;">Tip: Add weights like "Entry (Weight: 3)" (Premium)</small>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-primary" id="add-entries">
                            <i class="fas fa-plus"></i> Update List
                        </button>
                        <button class="btn btn-light" id="clear-entries">
                            <i class="fas fa-trash"></i> Clear All
                        </button>
                    </div>
                </div>

                <div class="control-group">
                    <h2><i class="fas fa-palette"></i> Customization</h2>
                     <div class="input-group">
                        <label>Wheel Color Theme</label>
                        <div class="theme-selector">
                            <div class="theme-option theme-default active" data-theme="default" title="Default Theme"></div>
                            <div class="theme-option theme-sunset" data-theme="sunset" title="Sunset Theme (Premium)"></div>
                            <div class="theme-option theme-forest" data-theme="forest" title="Forest Theme (Premium)"></div>
                            <div class="theme-option theme-ocean" data-theme="ocean" title="Ocean Theme (Premium)"></div>
                            </div>
                         <div class="premium-badge" style="top:5px; right: 5px;">PRO</div>
                    </div>
                    <div class="input-group premium-lock">
                         <div class="premium-badge">PRO</div>
                        <label>Spin Sounds</label>
                         <div class="toggle-switch">
                            <input type="checkbox" id="sound-toggle" class="switch" disabled>
                            <span class="slider"></span>
                            <label for="sound-toggle" style="cursor: not-allowed;">Enable Sounds</label>
                        </div>
                        <audio id="spin-sound" src="sounds/spin.mp3" preload="auto"></audio> <audio id="win-sound" src="sounds/win.mp3" preload="auto"></audio>   </div>
                     <div class="input-group premium-lock">
                        <div class="premium-badge">PRO</div>
                        <label for="wheel-style">Wheel Style</label>
                        <select id="wheel-style" disabled>
                            <option value="standard">Standard</option>
                            <option value="pie">Pie Chart</option>
                            <option value="neon">Neon Glow</option>
                        </select>
                    </div>
                </div>

                <div class="control-group premium-lock">
                    <div class="premium-badge">PRO</div>
                    <h2><i class="fas fa-cogs"></i> Advanced Settings</h2>
                     <div class="input-group">
                         <div class="toggle-switch">
                            <input type="checkbox" id="weighted-toggle" class="switch" disabled>
                             <span class="slider"></span>
                             <label for="weighted-toggle" style="cursor: not-allowed;">Enable Weighted Entries</label>
                         </div>
                         <small style="color:#777; font-size: 0.8rem;">Use format: "Entry Name (Weight: number)"</small>
                    </div>
                     <div class="input-group">
                        <label for="winner-count">Number of Winners</label>
                        <input type="number" id="winner-count" value="1" min="1" max="10" style="width: 80px;" disabled>
                    </div>
                    <div class="mt-1">
                         <a href="#" class="btn btn-light btn-sm" id="view-analytics-btn" style="opacity: 0.6; cursor: not-allowed;"><i class="fas fa-chart-line"></i> View Spin History</a>
                     </div>
                </div>

                <div class="control-group premium-lock">
                     <div class="premium-badge">PRO</div>
                    <h2><i class="fas fa-share-alt"></i> Share & Save</h2>
                    <p style="font-size: 0.9rem; color: #555; margin-bottom: 1rem;">Save your wheel configuration online and share it with friends or teams.</p>
                    <div class="btn-group">
                        <button class="btn btn-secondary" id="save-wheel-btn" disabled>
                            <i class="fas fa-cloud-upload-alt"></i> Save Online
                        </button>
                         <button class="btn btn-secondary" id="load-wheel-btn" disabled>
                            <i class="fas fa-cloud-download-alt"></i> Load Wheel
                        </button>
                    </div>
                     <div class="mt-1">
                         <button class="btn btn-light" id="share-modal-btn" disabled><i class="fas fa-share-square"></i> Share This Wheel</button>
                     </div>
                     <div class="mt-1">
                         <a href="#" class="btn btn-light btn-sm" id="team-collab-btn" style="opacity: 0.6; cursor: not-allowed;"><i class="fas fa-users"></i> Team Collaboration</a>
                     </div>
                </div>
            </div><div class="wheel-container">
                <div class="wheel-wrapper">
                    <div class="pointer"></div>
                    <div class="wheel" id="wheel">
                        <div class="wheel-center">
                            <i class="fas fa-star"></i> </div>
                    </div>
                </div>

                <button class="spin-btn" id="spin-btn">
                    <i class="fas fa-sync-alt"></i> SPIN THE WHEEL
                </button>

                 <div id="social-share-container" class="share-buttons mt-1 hidden">
                     <span>Share the result:</span>
                     <a href="#" target="_blank" class="share-btn twitter" id="share-twitter" title="Share on Twitter/X"><i class="fab fa-twitter"></i></a>
                     <a href="#" target="_blank" class="share-btn facebook" id="share-facebook" title="Share on Facebook"><i class="fab fa-facebook"></i></a>
                     <a href="#" target="_blank" class="share-btn whatsapp" id="share-whatsapp" title="Share on WhatsApp"><i class="fab fa-whatsapp"></i></a>
                     <button class="share-btn copy" id="copy-link-btn" title="Copy Link"><i class="fas fa-link"></i></button>
                 </div>

            </div></div> <div class="upgrade-cta" id="upgrade-cta">
            <h3 class="upgrade-title">ðŸš€ Unlock the Full Power of SpinSelect Pro!</h3>
            <p class="upgrade-subtitle">Get access to all premium features and create amazing experiences.</p>
            <div class="features-list">
                <div class="feature-item"><i class="fas fa-check-circle"></i><span>Multiple Color Themes</span></div>
                <div class="feature-item"><i class="fas fa-check-circle"></i><span>Engaging Spin Sounds</span></div>
                <div class="feature-item"><i class="fas fa-check-circle"></i><span>Advanced Wheel Styles</span></div>
                <div class="feature-item"><i class="fas fa-check-circle"></i><span>Weighted Entries Support</span></div>
                <div class="feature-item"><i class="fas fa-check-circle"></i><span>Select Multiple Winners</span></div>
                <div class="feature-item"><i class="fas fa-check-circle"></i><span>Unlimited Entries</span></div>
                <div class="feature-item"><i class="fas fa-check-circle"></i><span>Save Wheels to Cloud</span></div>
                <div class="feature-item"><i class="fas fa-check-circle"></i><span>Share Wheels Easily</span></div>
                 <div class="feature-item"><i class="fas fa-check-circle"></i><span>Spin History & Analytics</span></div>
                 <div class="feature-item"><i class="fas fa-check-circle"></i><span>Team Collaboration Features</span></div>
                 <div class="feature-item"><i class="fas fa-check-circle"></i><span>Ad-Free Experience</span></div>
                 <div class="feature-item"><i class="fas fa-check-circle"></i><span>Priority Support</span></div>
            </div>
            <button class="btn btn-accent upgrade-btn" id="upgrade-btn">
                <i class="fas fa-rocket"></i> Get Premium Access Now!
            </button>
             <p style="margin-top: 1rem; font-size: 0.9rem; color: #888;">Secure checkout via Whop.com</p>
        </div>

    </div><div id="winnerModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="modal-close-btn">&times;</span>
            <h2>ðŸŽ‰ Winner(s)! ðŸŽ‰</h2>
            <div id="winner-display">
                 </div>
             <div id="modal-share-buttons" class="share-buttons mt-1">
                 </div>
            <button class="btn btn-primary mt-1" id="spin-again-btn">Spin Again</button>
        </div>
    </div>

    <div id="confetti-container"></div>

     <footer>
        &copy; <span id="current-year"></span> SpinSelect Pro. Built for Whop.com deployment.
        | <a href="#" style="color: #777;">Support</a>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- DOM Elements ---
            const wheel = document.getElementById('wheel');
            const spinBtn = document.getElementById('spin-btn');
            const entriesTextarea = document.getElementById('entries');
            const addEntriesBtn = document.getElementById('add-entries');
            const clearEntriesBtn = document.getElementById('clear-entries');
            const upgradeBtn = document.getElementById('upgrade-btn');
            const themeOptions = document.querySelectorAll('.theme-option');
            const soundToggle = document.getElementById('sound-toggle');
            const weightedToggle = document.getElementById('weighted-toggle');
            const winnerCountInput = document.getElementById('winner-count');
            const modal = document.getElementById('winnerModal');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const winnerDisplay = document.getElementById('winner-display');
            const modalShareContainer = document.getElementById('modal-share-buttons');
            const socialShareContainer = document.getElementById('social-share-container');
            const spinAgainBtn = document.getElementById('spin-again-btn');
            const confettiContainer = document.getElementById('confetti-container');
            const spinSound = document.getElementById('spin-sound');
            const winSound = document.getElementById('win-sound');
            const saveWheelBtn = document.getElementById('save-wheel-btn'); // Placeholder
            const loadWheelBtn = document.getElementById('load-wheel-btn'); // Placeholder
            const shareModalBtn = document.getElementById('share-modal-btn'); // Placeholder
            const viewAnalyticsBtn = document.getElementById('view-analytics-btn'); // Placeholder
            const teamCollabBtn = document.getElementById('team-collab-btn'); // Placeholder

            // --- State Variables ---
            let currentEntries = []; // Array of objects: { text: 'Entry 1', weight: 1 }
            let currentRotation = 0;
            let spinning = false;
            let isPremium = false; // This will be set by Whop integration
            let soundEnabled = false;
            let weightedEnabled = false;
            let winnerCount = 1;
            let currentTheme = 'default'; // Default theme

            // --- Whop Integration (Simulated) ---
            function checkPremiumStatus() {
                // ** REAL IMPLEMENTATION REQUIRED **
                // This function needs to securely verify the user's license key
                // passed via URL (?key=LICENSE_KEY) or using Whop's API/SDK.
                // For demonstration, we'll use a simple check.
                const urlParams = new URLSearchParams(window.location.search);
                const licenseKey = urlParams.get('key'); // Whop usually passes the key like this

                // Example: Check local storage or validate key (replace with actual validation)
                if (licenseKey === 'VALID_PREMIUM_KEY' || localStorage.getItem('spinselect_premium') === 'true') {
                     if (licenseKey === 'VALID_PREMIUM_KEY') {
                        localStorage.setItem('spinselect_premium', 'true'); // Persist status
                    }
                    isPremium = true;
                    document.body.classList.add('premium');
                    console.log("Premium features ACTIVATED.");
                    enablePremiumFeatures();
                } else {
                    isPremium = false;
                    document.body.classList.remove('premium');
                    console.log("Running in FREE mode.");
                    applyFreeLimitations();
                }
            }

            function enablePremiumFeatures() {
                // Remove 'premium-lock' visual styles and enable controls
                document.querySelectorAll('.premium-lock').forEach(el => {
                     // Enable contained form elements
                    el.querySelectorAll('input, select, button, textarea').forEach(input => {
                        input.disabled = false;
                        if (input.labels && input.labels[0]) input.labels[0].style.cursor = 'pointer';
                         if (input.classList.contains('slider')) {
                             input.parentElement.style.cursor = 'pointer'; // Enable toggle switch click
                         }
                    });
                    el.querySelectorAll('a.btn').forEach(a => {
                        a.style.opacity = '1';
                        a.style.pointerEvents = 'auto';
                        a.style.cursor = 'pointer';
                    });
                     el.querySelectorAll('label').forEach(label => {
                         label.style.cursor = 'pointer';
                     })
                });
                 // Update state variables based on potentially saved premium settings
                soundEnabled = soundToggle.checked;
                weightedEnabled = weightedToggle.checked;
                winnerCount = parseInt(winnerCountInput.value) || 1;

                // Add event listeners for premium features
                soundToggle.addEventListener('change', handleSoundToggle);
                weightedToggle.addEventListener('change', handleWeightedToggle);
                winnerCountInput.addEventListener('change', handleWinnerCountChange);

                // Activate Premium Theme Selection
                themeOptions.forEach(option => {
                    option.addEventListener('click', handleThemeChange);
                    option.style.cursor = 'pointer'; // Ensure cursor is pointer
                });

                 // TODO: Add functionality for Save/Load/Share/Analytics/Teams buttons
                 saveWheelBtn.onclick = () => alert('Premium Feature: Save Wheel functionality needs backend integration.');
                 loadWheelBtn.onclick = () => alert('Premium Feature: Load Wheel functionality needs backend integration.');
                 shareModalBtn.onclick = () => alert('Premium Feature: Share Wheel functionality needs backend integration.');
                 viewAnalyticsBtn.onclick = () => alert('Premium Feature: Analytics functionality needs backend integration.');
                 teamCollabBtn.onclick = () => alert('Premium Feature: Team Collaboration needs backend integration.');

            }

             function applyFreeLimitations() {
                // Ensure premium controls are visually locked and disabled
                 document.querySelectorAll('.premium-lock').forEach(el => {
                     el.querySelectorAll('input, select, button, textarea').forEach(input => {
                         input.disabled = true;
                         if (input.labels && input.labels[0]) input.labels[0].style.cursor = 'not-allowed';
                         if (input.classList.contains('slider')) {
                             input.parentElement.style.cursor = 'not-allowed';
                         }
                     });
                      el.querySelectorAll('a.btn').forEach(a => {
                         a.style.opacity = '0.6';
                         a.style.pointerEvents = 'none';
                         a.style.cursor = 'not-allowed';
                     });
                     el.querySelectorAll('label').forEach(label => {
                         label.style.cursor = 'not-allowed';
                     })
                 });

                // Disable premium theme options (except default)
                themeOptions.forEach(option => {
                    if (!option.classList.contains('theme-default')) {
                        option.style.cursor = 'not-allowed';
                        option.removeEventListener('click', handleThemeChange);
                    } else {
                         option.addEventListener('click', handleThemeChange); // Allow default theme click
                    }
                });
                 // Reset settings to free defaults
                 soundToggle.checked = false;
                 weightedToggle.checked = false;
                 winnerCountInput.value = 1;
                 soundEnabled = false;
                 weightedEnabled = false;
                 winnerCount = 1;

                // Remove event listeners for premium features
                soundToggle.removeEventListener('change', handleSoundToggle);
                weightedToggle.removeEventListener('change', handleWeightedToggle);
                winnerCountInput.removeEventListener('change', handleWinnerCountChange);

                 // Disable premium buttons explicitly
                  const premiumButtons = [saveWheelBtn, loadWheelBtn, shareModalBtn, viewAnalyticsBtn, teamCollabBtn];
                  premiumButtons.forEach(btn => {
                      if(btn) {
                          btn.disabled = true;
                          btn.onclick = () => document.getElementById('upgrade-cta').scrollIntoView({ behavior: 'smooth' }); // Scroll to CTA on click
                      }
                  });
            }


            // --- Core Wheel Logic ---
            function parseEntries(text) {
                const lines = text.split('\n').map(line => line.trim()).filter(line => line);
                const entries = [];
                 const weightRegex = /\(Weight:\s*(\d+)\s*\)/i; // Case-insensitive regex

                lines.forEach(line => {
                    let text = line;
                    let weight = 1;

                    const match = line.match(weightRegex);
                    if (isPremium && weightedEnabled && match) {
                        text = line.replace(weightRegex, '').trim();
                        weight = parseInt(match[1], 10);
                        if (isNaN(weight) || weight < 1) {
                            weight = 1; // Default to 1 if invalid weight
                        }
                    } else {
                         text = line.replace(weightRegex, '').trim(); // Still remove "(Weight: X)" text even if not used
                    }


                    if (text) {
                        entries.push({ text: text, weight: weight });
                    }
                });

                 // Free version limitation
                 if (!isPremium && entries.length > 10) {
                    alert('Free version is limited to 10 entries. Please upgrade for unlimited entries.');
                    return entries.slice(0, 10); // Return only the first 10
                }

                return entries;
            }

            function updateWheel() {
                wheel.innerHTML = `<div class="wheel-center"><i class="fas fa-star"></i></div>`; // Reset wheel content
                const totalWeight = currentEntries.reduce((sum, entry) => sum + entry.weight, 0);
                const itemsToDraw = isPremium && weightedEnabled ? createWeightedList() : currentEntries;

                 if (itemsToDraw.length === 0) {
                     // Display placeholder when no entries
                     const placeholderSection = document.createElement('div');
                     placeholderSection.className = 'wheel-section';
                     placeholderSection.style.background = '#eee';
                     placeholderSection.style.transform = 'rotate(0deg)';
                     placeholderSection.style.clipPath = 'polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)'; // Full circle segment

                     const placeholderContent = document.createElement('div');
                     placeholderContent.className = 'wheel-section-content';
                     placeholderContent.textContent = 'Add entries below!';
                      placeholderContent.style.transform = 'translate(-50%, -50%) rotate(0deg)';
                      placeholderContent.style.position = 'absolute';
                      placeholderContent.style.top = '50%';
                      placeholderContent.style.left = '50%';
                      placeholderContent.style.width = '100%';
                      placeholderContent.style.height = 'auto';
                      placeholderContent.style.color = '#888';
                      placeholderContent.style.textShadow = 'none';


                     placeholderSection.appendChild(placeholderContent);
                     wheel.appendChild(placeholderSection);
                     return;
                 }


                const sectionAngle = 360 / itemsToDraw.length;
                 // Theme colors
                const themeColors = getThemeColors(currentTheme);

                itemsToDraw.forEach((entry, index) => {
                    const angle = sectionAngle * index;
                    const section = document.createElement('div');
                    section.className = 'wheel-section';

                    // Calculate transform for segment
                    const skewY = sectionAngle <= 90 ? 90 - sectionAngle : 0; // Adjust skew for > 4 segments
                    section.style.transform = `rotate(${angle}deg) skewY(-${skewY}deg)`;

                     // Apply themed background color
                    const colorIndex = index % themeColors.length;
                    section.style.background = themeColors[colorIndex];


                     // Clip-path calculation (simplified for broad compatibility)
                     const clipAngle = sectionAngle * (Math.PI / 180); // Angle in radians
                     const clipX = 50 + 50 * Math.tan(clipAngle / 2);
                     if (sectionAngle < 180) {
                         section.style.clipPath = `polygon(50% 50%, 0% 0%, ${clipX}% 0%)`;
                     } else { // Handle cases with 1 or 2 entries
                          section.style.clipPath = `polygon(50% 50%, 0% 0%, 100% 0%, 100% 100%, 0% 100%)`;
                     }


                    const content = document.createElement('div');
                    content.className = 'wheel-section-content';
                    content.textContent = entry.text;

                    // Adjust text rotation to be readable
                     const textRotation = 90 + sectionAngle / 2;
                     content.style.transform = `skewY(${skewY}deg) rotate(${textRotation}deg) translate(-50%, -50%)`;
                    // Adjust position for better centering within segment
                     content.style.position = 'absolute';
                     content.style.left = '50%';
                     content.style.top = '25%'; // Move text towards the outer edge
                    content.style.width = '90%'; // Prevent overflow

                     // Adjust font size based on number of items and text length
                     const baseFontSize = 1.1; // Base font size in rem
                     const lengthFactor = Math.max(0.4, 1 - (entry.text.length / 20)); // Reduce size for long text
                     const countFactor = Math.max(0.5, 1 - (itemsToDraw.length / 30)); // Reduce size for many items
                     content.style.fontSize = `clamp(0.6rem, ${baseFontSize * lengthFactor * countFactor}rem, 1.2rem)`;

                    section.appendChild(content);
                    wheel.appendChild(section);
                });
            }

            // Creates a list where items are repeated based on weight for fair selection
            function createWeightedList() {
                const weightedList = [];
                currentEntries.forEach(entry => {
                    for (let i = 0; i < entry.weight; i++) {
                        weightedList.push(entry); // Add reference to the original entry object
                    }
                });
                 // Shuffle the weighted list to ensure randomness in wheel display order
                 // (Fisher-Yates Shuffle)
                 for (let i = weightedList.length - 1; i > 0; i--) {
                     const j = Math.floor(Math.random() * (i + 1));
                     [weightedList[i], weightedList[j]] = [weightedList[j], weightedList[i]];
                 }
                return weightedList;
            }


            function spinWheel() {
                const itemsToSpin = isPremium && weightedEnabled ? createWeightedList() : currentEntries;

                if (spinning || itemsToSpin.length === 0) return;
                spinning = true;
                spinBtn.disabled = true;
                spinBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> SPINNING...';
                wheel.classList.add('spinning'); // Add class for specific spin transition
                 hideSocialShare(); // Hide previous results share buttons


                 if (soundEnabled && spinSound) {
                     spinSound.currentTime = 0;
                     spinSound.play().catch(e => console.error("Error playing spin sound:", e));
                 }

                const numSpins = 8 + Math.random() * 5; // More spins
                const spinDuration = 6000; // Fixed duration matches CSS transition
                const totalRotation = 360 * numSpins;
                const sectionAngle = 360 / itemsToSpin.length;
                // Calculate winning angle - ensure it lands IN the segment, not on the line
                const randomAngleWithinSegment = (Math.random() * 0.8 + 0.1) * sectionAngle; // Land between 10% and 90% of the segment
                const targetAngle = Math.random() * 360; // Pick a random target angle first
                const finalRotation = totalRotation + targetAngle;

                currentRotation = finalRotation; // Store the final rotation
                wheel.style.transform = `rotate(${currentRotation}deg)`;

                setTimeout(() => {
                    spinning = false;
                    spinBtn.disabled = false;
                    spinBtn.innerHTML = '<i class="fas fa-sync-alt"></i> SPIN THE WHEEL';
                     wheel.classList.remove('spinning'); // Remove class to revert to default transition


                    // Calculate winners based on the final angle
                    const actualAngle = currentRotation % 360;
                    const winners = determineWinners(itemsToSpin, actualAngle, winnerCount);

                     // --- Store Spin History (Premium - Placeholder) ---
                     if (isPremium) {
                         // Needs backend or advanced local storage implementation
                         console.log("Spin Result:", { winners: winners.map(w => w.text), timestamp: new Date() });
                         // storeSpinResult(winners);
                     }

                    showWinnerModal(winners);

                }, spinDuration + 100); // Add slight buffer after transition ends
            }

             function determineWinners(items, finalAngle, count) {
                 const winners = [];
                 const sectionAngle = 360 / items.length;
                 const selectedIndices = new Set(); // Keep track of selected physical slots

                 // Find the index of the segment the pointer lands on
                 const firstWinnerPhysicalIndex = Math.floor(((360 - finalAngle) % 360) / sectionAngle);

                 if (items[firstWinnerPhysicalIndex]) {
                      winners.push(items[firstWinnerPhysicalIndex]);
                      selectedIndices.add(firstWinnerPhysicalIndex);
                 } else {
                     console.error("Could not determine winner for index:", firstWinnerPhysicalIndex);
                     // Fallback: just pick a random item if calculation fails
                     if(items.length > 0) winners.push(items[Math.floor(Math.random() * items.length)]);
                     return winners; // Return only the fallback winner
                 }


                 // Select additional unique winners if needed (Premium)
                 let attempts = 0; // Prevent infinite loops
                 while (winners.length < count && winners.length < items.length && attempts < items.length * 2) {
                     const randomIndex = Math.floor(Math.random() * items.length);
                     // Ensure the randomly picked item *and* its original physical slot haven't been chosen
                     // This prevents picking the same name twice if it appears multiple times due weighted entries
                     // AND prevents picking the same physical slot twice
                     if (!selectedIndices.has(randomIndex)) {
                         // Check if this item text is already a winner (important for weighted where same text exists)
                         const alreadyWinner = winners.some(winner => winner.text === items[randomIndex].text);
                         if (!alreadyWinner) {
                            winners.push(items[randomIndex]);
                         }
                         selectedIndices.add(randomIndex); // Mark this physical slot as used
                     }
                     attempts++;
                 }

                 return winners;
             }

             function showWinnerModal(winners) {
                 if (winners.length === 0) return;

                 if (soundEnabled && winSound) {
                     winSound.currentTime = 0;
                     winSound.play().catch(e => console.error("Error playing win sound:", e));
                 }
                 launchConfetti();

                 winnerDisplay.innerHTML = ''; // Clear previous content
                 if (winners.length === 1) {
                     const winnerP = document.createElement('p');
                     winnerP.className = 'winner-name';
                     winnerP.textContent = winners[0].text;
                     winnerDisplay.appendChild(winnerP);
                 } else {
                     const winnerList = document.createElement('ul');
                     winnerList.className = 'winner-list';
                     winners.forEach(winner => {
                         const li = document.createElement('li');
                         li.textContent = winner.text;
                         winnerList.appendChild(li);
                     });
                     winnerDisplay.appendChild(winnerList);
                 }

                  // Show and populate share buttons in modal
                  populateShareButtons(winners.map(w => w.text).join(', '));
                  modalShareContainer.innerHTML = socialShareContainer.innerHTML; // Copy buttons
                  attachShareButtonListeners(modalShareContainer, winners.map(w => w.text).join(', ')); // Re-attach listeners for modal buttons

                 modal.style.display = 'block';
             }

            function closeModal() {
                modal.style.display = 'none';
                stopConfetti();
            }

            // --- Confetti ---
            let confettiInterval;
            function launchConfetti() {
                stopConfetti(); // Clear any existing confetti
                confettiInterval = setInterval(createConfettiPiece, 100); // Create confetti continuously
                setTimeout(stopConfetti, 4000); // Stop after 4 seconds
            }

            function stopConfetti() {
                clearInterval(confettiInterval);
                 // Optionally remove remaining confetti elements after a delay
                 setTimeout(() => {
                     confettiContainer.innerHTML = '';
                 }, 3000);
            }

            function createConfettiPiece() {
                 const confetti = document.createElement('div');
                 confetti.className = 'confetti';
                 const colors = getThemeColors(currentTheme); // Use theme colors
                 confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                 confetti.style.left = Math.random() * 100 + 'vw';
                 // Start slightly above the viewport
                 confetti.style.top = '-20px';
                 // Randomize horizontal movement and rotation
                 const randomX = (Math.random() - 0.5) * 500; // Horizontal drift
                 const randomRot = Math.random() * 720 - 360; // Rotation
                 confetti.style.transform = `translateX(${randomX}px) rotate(${randomRot}deg)`;

                 // Randomize animation duration and delay
                 const duration = Math.random() * 2 + 3; // 3-5 seconds fall time
                 confetti.style.animation = `fall ${duration}s linear forwards`;
                 confetti.style.width = (Math.random() * 5 + 5) + 'px'; // Random size
                 confetti.style.height = confetti.style.width;
                  if (Math.random() > 0.5) { // Make some rectangular
                      confetti.style.height = (parseInt(confetti.style.width) / 2) + 'px';
                  }
                 confetti.style.opacity = Math.random() * 0.5 + 0.5; // Random opacity

                 confettiContainer.appendChild(confetti);

                 // Remove confetti element from DOM after animation ends
                 setTimeout(() => {
                     confetti.remove();
                 }, duration * 1000);
            }

            // --- Theme Handling ---
             function getThemeColors(themeName) {
                // Define color palettes for themes
                 const themes = {
                     'default': ['#6a11cb', '#2575fc', '#a29bfe', '#6c5ce7', '#00d2d3'],
                     'sunset': ['#ff8c00', '#ff0080', '#ff4e50', '#fc913a', '#f9d423'],
                     'forest': ['#138d75', '#27ae60', '#58b368', '#82c97c', '#abdda4'],
                     'ocean': ['#00c6ff', '#0072ff', '#4facfe', '#00f2fe', '#89f7fe'],
                     // Add more themes here
                 };
                 return themes[themeName] || themes['default']; // Fallback to default
             }

             function applyTheme(themeName) {
                 currentTheme = themeName;
                 // Update active class on theme selector
                 themeOptions.forEach(opt => {
                     opt.classList.toggle('active', opt.dataset.theme === themeName);
                 });
                 // Re-draw the wheel with new colors
                 updateWheel();
                 // Optional: You could also change other UI elements based on theme
                 // document.documentElement.style.setProperty('--primary', getThemeColors(themeName)[0]);
             }

             function handleThemeChange(event) {
                 const selectedTheme = event.target.dataset.theme;
                  // Check if the clicked theme is premium and user is not premium
                 const isPremiumTheme = !event.target.classList.contains('theme-default'); // Assuming default is free
                 if (isPremiumTheme && !isPremium) {
                     alert('This theme is a premium feature. Please upgrade to use it.');
                      document.getElementById('upgrade-cta').scrollIntoView({ behavior: 'smooth' });
                     return;
                 }
                 applyTheme(selectedTheme);
             }

             // --- Settings Handlers (Premium Features) ---
              function handleSoundToggle() {
                 if (!isPremium) return; // Should be disabled anyway, but double-check
                 soundEnabled = soundToggle.checked;
                 console.log("Sounds enabled:", soundEnabled);
                 // You might want to play a test sound here
             }

              function handleWeightedToggle() {
                 if (!isPremium) return;
                 weightedEnabled = weightedToggle.checked;
                 console.log("Weighted entries enabled:", weightedEnabled);
                 // Re-parse entries and update wheel if needed, as weights might now apply/unapply
                 currentEntries = parseEntries(entriesTextarea.value);
                 updateWheel();
             }

             function handleWinnerCountChange() {
                 if (!isPremium) return;
                 let count = parseInt(winnerCountInput.value);
                 if (isNaN(count) || count < 1) {
                     count = 1;
                     winnerCountInput.value = 1; // Correct invalid input
                 }
                  // Limit max winners based on number of unique entries?
                 const uniqueEntries = new Set(currentEntries.map(e => e.text)).size;
                 if (count > uniqueEntries && uniqueEntries > 0) {
                     count = uniqueEntries;
                      winnerCountInput.value = count;
                      alert(`Cannot select more winners than unique entries (${uniqueEntries}).`);
                 } else if (count > 50) { // Arbitrary upper limit
                      count = 50;
                      winnerCountInput.value = count;
                      alert(`Maximum number of winners is 50.`);
                 }
                 winnerCount = count;
                 console.log("Number of winners set to:", winnerCount);
             }

            // --- Social Sharing ---
             function populateShareButtons(winnerText) {
                 const shareText = encodeURIComponent(`Check out the result from SpinSelect Pro: ${winnerText}!`);
                 const shareUrl = encodeURIComponent(window.location.href); // URL of the current page

                 const twitterBtn = socialShareContainer.querySelector('#share-twitter');
                 const facebookBtn = socialShareContainer.querySelector('#share-facebook');
                 const whatsappBtn = socialShareContainer.querySelector('#share-whatsapp');
                 const copyBtn = socialShareContainer.querySelector('#copy-link-btn');

                 if(twitterBtn) twitterBtn.href = `https://twitter.com/intent/tweet?text=${shareText}&url=${shareUrl}`;
                 if(facebookBtn) facebookBtn.href = `https://www.facebook.com/sharer/sharer.php?u=${shareUrl}&quote=${shareText}`;
                 if(whatsappBtn) whatsappBtn.href = `https://api.whatsapp.com/send?text=${shareText}%20${shareUrl}`;

                 // Attach listener specifically for copy button within the current context (modal or main page)
                 attachShareButtonListeners(socialShareContainer, winnerText); // Attach listeners for main page buttons

                 // Make the container visible
                 socialShareContainer.classList.remove('hidden');
            }

             function attachShareButtonListeners(container, winnerText) {
                 const copyBtn = container.querySelector('#copy-link-btn');
                  if (copyBtn) {
                      copyBtn.onclick = (e) => {
                          e.preventDefault();
                          const textToCopy = `SpinSelect Pro Result: ${winnerText} - See it here: ${window.location.href}`;
                          navigator.clipboard.writeText(textToCopy).then(() => {
                              alert('Result link copied to clipboard!');
                          }).catch(err => {
                              console.error('Failed to copy text: ', err);
                              alert('Failed to copy link.');
                          });
                      };
                  }
             }


            function hideSocialShare() {
                socialShareContainer.classList.add('hidden');
                 modalShareContainer.innerHTML = ''; // Clear modal share buttons too
            }

            // --- Event Listeners ---
            addEntriesBtn.addEventListener('click', function() {
                currentEntries = parseEntries(entriesTextarea.value);
                updateWheel();
                // Optional: Clear textarea after adding?
                // entriesTextarea.value = '';
                 hideSocialShare(); // Hide share buttons when list changes
            });

            clearEntriesBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to clear all entries?')) {
                    currentEntries = [];
                    entriesTextarea.value = '';
                    updateWheel();
                    hideSocialShare();
                }
            });

            spinBtn.addEventListener('click', spinWheel);

            upgradeBtn.addEventListener('click', function() {
                // ** Replace with your actual Whop checkout link **
                const whopCheckoutUrl = "YOUR_WHOP_CHECKOUT_LINK_HERE";
                 if (whopCheckoutUrl === "YOUR_WHOP_CHECKOUT_LINK_HERE") {
                     alert("Please replace 'YOUR_WHOP_CHECKOUT_LINK_HERE' in the script with your actual Whop checkout URL.");
                 } else {
                    alert("Redirecting to Whop to complete your upgrade...");
                    window.location.href = whopCheckoutUrl;
                 }
            });

             modalCloseBtn.addEventListener('click', closeModal);
             spinAgainBtn.addEventListener('click', () => {
                 closeModal();
                 spinWheel(); // Immediately spin again
             });

             // Close modal if clicked outside the content
             window.addEventListener('click', function(event) {
                 if (event.target === modal) {
                     closeModal();
                 }
             });

              // Initial Setup
             document.getElementById('current-year').textContent = new Date().getFullYear();
             checkPremiumStatus(); // Check license key on load
             currentEntries = parseEntries(entriesTextarea.value || "Entry 1\nEntry 2\nEntry 3"); // Load initial/example entries
             applyTheme(currentTheme); // Applies default theme and updates wheel
             updateWheel(); // Draw initial wheel state

        });
    </script>

</body>
</html>
